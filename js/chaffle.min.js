!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Chaffle=e()}(this,function(){"use strict";function t(){var e={},a=!1;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(a=arguments[0],n++);for(var n=0;n<arguments.length;n++){var i=arguments[n];!function(n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(a&&"[object Object]"===Object.prototype.toString.call(n[i])?e[i]=t(!0,e[i],n[i]):e[i]=n[i])}(i)}return e}function e(e,a,n){var i={},s=e.getAttribute("data-chaffle"),r=e.getAttribute("data-chaffle-speed"),h=e.getAttribute("data-chaffle-delay"),o=e.getAttribute("data-chaffle-maxlength");s&&0!==s.length&&(i.lang=s),null!==r&&(i.speed=Number(r)),null!==h&&(i.delay=Number(h)),null!==o&&(i.maxlength=Number(o)),this.element=e,this.text=this.element.textContent,this.textValueMode=!this.text&&this.text.length<1,a.intext&&a.intext.length>0?this.text=a.intext:this.text=this.textValueMode?this.element.value:this.text,this.substitution="",this.state=!1,this.shuffleProps=[],this.reinstateProps=[],this.options={lang:"en",speed:20,delay:100,maxlength:this.text.length},this.options=t(this.options,a,i),this.callback=n}return e.prototype={constructor:e,init:function(){var t=this;if(!t.state){t.clearShuffleTimer(),t.clearReinstateTimer(),t.state=!0,t.substitution="",t.shuffleProps=[],t.reinstateProps=[];var e=setInterval(function(){t.shuffle()},t.options.speed),a=setInterval(function(){t.reinstate()},t.options.delay);t.shuffleProps=e,t.reinstateProps=a}},shuffle:function(){this.textValueMode?this.element.value=this.substitution:this.element.textContent=this.substitution;var t=this.text.length,e=this.substitution.length;if(t-e>0)if(this.textValueMode)for(var a=0;a<=t-e;a++)this.element.value=this.element.value+this.randomStr();else for(var a=0;a<=t-e;a++)this.element.textContent=this.element.textContent+this.randomStr();else this.clearShuffleTimer()},reinstate:function(){var t=this.text.length,e=this.substitution.length;e<t?e>=this.options.maxlength?(this.textValueMode?this.element.value=this.text:this.element.textContent=this.text,this.clearShuffleTimer(),this.clearReinstateTimer(),this.callback&&this.callback()):this.textValueMode?this.element.value=this.substitution=this.text.substr(0,e+1):this.element.textContent=this.substitution=this.text.substr(0,e+1):(this.clearReinstateTimer(),this.callback&&this.callback()),this.state=!1},clearShuffleTimer:function(){return clearInterval(this.shuffleProps)},clearReinstateTimer:function(){return clearInterval(this.reinstateProps)},randomStr:function(){var t;switch(this.options.lang){case"sym":t=[[33,14],[58,6],[91,5],[123,3]][Math.round(3*Math.random())],t=String.fromCharCode(t[0]+Math.round(Math.random()*t[1]));break;case"en":t=String.fromCharCode(48+Math.round(74*Math.random()));break;case"zh":t=String.fromCharCode(19968+Math.round(80*Math.random()));break;case"ja-hiragana":t=String.fromCharCode(12352+Math.round(50*Math.random()));break;case"ja-katakana":t=String.fromCharCode(12448+Math.round(84*Math.random()));break;case"ua":t=String.fromCharCode(1040+Math.round(55*Math.random()));break;default:t=String.fromCharCode(48+Math.round(74*Math.random()))}return t}},e});